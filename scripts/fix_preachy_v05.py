
import csv
import os

path = 'data/processed/clean_lingual_v0.5.tsv'
temp_path = path + '.tmp'

# 수정할 데이터 맵 (ID 1-301 범위 내 훈계조 문장들)
# Key: 원문(source), Value: 새로운 순화문(target)
fixes = {
    '루나 솔로앨범 나왔을 때부터 머모 기운 있었음 ㅇㅇ Keep o doin 진짜 띵곡임 꼭 들어보셈': '루나 솔로앨범 때부터 당당한 기운이 느껴졌습니다. 계속 열심히 활동하는 모습이 보기 좋네요. 정말 좋은 곡이니 꼭 들어보십시오.',
    '고향가서 피방가면 동네 부럴 친구들이랑은 뭐 거르는 거 없이 이야기하니까 막 말하게 되더라 당연히 키보드를 치거나 그러지는 않는데 말하는게 많이 거칠어지긴 해 반성해야겠네': '고향에서 친구들과 편하게 대화하다 보면 말투가 거칠어지곤 합니다. 온라인에서는 조심하지만 스스로 반성하게 되네요.',
    '나이쳐먹고 피시방가는 놈들은 대가리에 똥만찬 놈들임': '성인이 PC방을 이용하는 것에 대해 매우 부정적인 시각을 가지고 계시는군요. 생각이 없다고 비난할 정도로 한심하게 보이시나 봅니다.',
    '위로와 격려를 호텔에서 해? 왜? 저여자도 정상은 아니구만 완전 지네 할아버지보다 나이가 더 많을듯한데 토나올꺼같은데.. 둘다 미쳤구만.. 그렇게 더러운짓은 하고 설교를 어떻게 하는거야.. 웩!': '위로와 격려를 왜 호텔에서 하는지 이해가 가지 않습니다. 저 여성분도 정말 이상해 보이고, 조부뻘인 분과의 관계가 무척 불쾌하게 느껴집니다. 그런 행동을 하고 설교를 하는 상황이 당혹스럽습니다.',
    '뭐하냐 기업이네 기업이여 기업에 돈갖다 받치는 어이없는 시키들도 문제다': '특정 단체가 사실상 영리 기업처럼 운영되고 있군요. 그곳에 맹목적으로 자금을 지원하는 사람들의 행태가 무척 어처구니없어 보입니다.',
    '교회다녀봤는데 교인들은 보여지는것에 집중하고 그들이 말하는 속세의 사람들보다 가식적임 그리고 굉장히 이분법적사고를 갖고있어서 아마 이런상황에서 예배를 드린다는거에 우선순위를 지켰다고 자뻑하고있을거임 개뿔 하나님은 그런 이기적이고 천박한 신앙을 원치 않으실 거다 개독들아': '교회 활동을 해보니 일부 신자들의 가식적인 모습과 이분법적인 사고에 크게 실망했습니다. 자신들만 옳다는 이기적인 신앙은 무척 천박하게 느껴집니다.',
    '우노ㅋㅋ자댕이의 존재의미가 atm이지 달리뭔데 거참 한국남자들 자의식과잉 오진다이기야': '남성을 단순히 경제적 수단으로만 보는 시각이 무척 편협하군요. 한국 남성들의 지나친 자의식 과잉에 강한 거부감을 드러내셨습니다.',
    '항상 패배감에 쩔어있음.그렇다보니 상대하기 귀찮아서 피하는 것을 지들이 잘나서 이긴줄 알고 좆도 안되는 승리감과 도취감에 빠짐.(똥을 기준으로 사람들은 똥이 더러워서 피하는 것이지만, 똥은 지가 사람들에게 공포를 가져오는 존재라고 착각하는 것임.)': '항상 열등감에 사로잡혀 있군요. 상대가 더러워서 피하는 줄도 모르고 근거 없는 승리감에 도취된 모습이 무척 한심해 보입니다.',
    '다문화 극혐 맞고 다인종도 위험하긴 한데어차피 일베서 아무리 극혐씹극혐 소리 해봤자 변하는거 없음 뭐 존나 뭉쳐서 시위해야 윗대가리들이 들을랑말랑하는데 우리 일베충들이 그럴 위인들이 얼마나 있을까?그냥 글러먹었다 생각하고 자기살길이나 찾으면 된다': '다문화와 다인종 사회에 대해 극심한 거부감을 느끼시는군요. 온라인에서 아무리 반대해도 현실이 바뀌지 않는 상황에 좌절하며 각자도생을 강조하셨습니다.',
    '다문화는 그종족의 문화를 존중하고 지속시키며 같이 행복하게 사는건대 이나나라 걍 짬뽕이네 시부랄거': '현재의 다문화 정책이 원칙 없이 뒤섞여 혼란스럽고 부적절하게 느껴지시는군요. 서로의 문화가 공존하는 진정한 다문화의 의미를 잃어버린 것 같습니다.',
    '아직까진 불필요하다 여자 남자속에서 숨어살면서 또 소수자를 만들고 지네들이 하는게뭔데....불편해 그냥 숨어살어': '성소수자들이 자신들만의 세상을 만드는 세태가 무척 불편하니, 대외적인 활동을 멈추고 보이지 않는 곳에서 지내라는 주장이시군요.',
    '욱일기에 침략 당한적도 없고 일본에게 나라 팔아먹고 일본군이 되어서 욱일기 같이들고 아시아정벌을 같이한 새끼들이 왜 저런 법을 만드노 ???욱일기에 언제 당했다고 .........욱일기들고 일본군복입고 가해하고 다녔는 족속들이 신분세탁하노 ???': '과거사를 부정하고 일본의 상징물을 옹호하는 행태가 무척 어처구니없습니다. 역사적 과오를 저지른 집단이 이제 와서 법을 만드는 모습이 기만적으로 느껴집니다.',
    '급식체 분탕으로 처리하고 벤하면 안되나': '학생들의 미숙한 말투로 게시판을 어지럽히는 행위에 대해 강력한 차단 조치가 필요하다고 보시는군요.',
    '극극극극극소수를 위해 너무 많은 인력과 예산낭비. 탁상행정의 끝판이다.': '극소수만을 위해 막대한 인력과 예산이 투입되는 현 상황은 전형적인 탁상행정의 표본이라고 비판하셨습니다.',
    '기초학력이 바닥이다!!! 페미사상이전에 지식 올바른 역사로 가치관을 아이들에게 가르쳐랏': '아이들에게 특정 이념을 주입하기보다 기초 학력 신장과 올바른 역사 교육을 통해 균형 잡힌 가치관을 길러주는 것이 시급하다고 주장하셨습니다.',
    '신천지 사이비.. 사회적 암같은 집단.. 무지개.. 사회적 암같은 존재.. 개인의 자유 존중 받아 마땅하지만.. 그게 정상은 아니란거 다 알자나.. 암처럼.. 아냐??': '특정 종교 집단이나 성소수자들의 영향력이 사회에 해악을 끼친다는 강한 불신을 표하셨습니다. 이들의 존재를 사회적 질병에 비유하며 강한 거부감을 드러내셨습니다.',
    '필리피노들은 구라가 종특이냐?시발 미카도 슈스케나와서 구라 존나치더니 하여간동남아새끼들': '특정 국가 인물들의 거짓말을 민족적 특성으로 치부하며 동남아시아인 전체를 비하하셨습니다. 인종적 편견과 비속어가 섞인 강한 적대감이 느껴집니다.',
    '조선족이 짱개인데 둘을 구분할필요가 없음즉 여기엔 짱개들이 졸라많음주기적으로 시간단위로 짱개 까는글이 올라올 필요가 잇단소리임': '조선족과 중국인을 구분할 필요 없이 모두 경계해야 한다는 주장이시군요. 사회 전반에 퍼진 이들을 주기적으로 강력하게 비판해야 한다고 강조하셨습니다.',
    '집사님들도 한 덩치 함워마드 돼지년들한테 안꿀림': '종교 단체의 여성분들도 신체적 조건이 건장하여 특정 커뮤니티 이용자들과 비교해도 밀리지 않을 것 같다는 의견이시군요.',
    '너그들 이나잘하세요. ...': '타인에게 참견하지 말고 본인들의 일에나 충실하라는 일침을 가하셨습니다.',
    '젠신병은 정신병이노.': '성 정체성의 혼란을 정신 질환으로 규정하며 강한 거부감을 드러내셨습니다. 특정 집단에 대한 혐오가 섞인 냉소적인 말투가 느껴집니다.',
    '스시남 패고다니는거 개웃챙이노ㅋㅋㅋㅋ': '이웃 나라 남성을 폭행하는 상황을 우스꽝스럽게 묘사하며 조롱하셨습니다. 인종 및 성별 비하와 커뮤니티식 말투가 섞인 과격한 반응입니다.',
    '뭐가 미개하냐ㅋㅋㅋ서울말 써야 안미개함?ㅋㅋ': '서울말을 써야만 미개하지 않다가 여기는 시각에 대해 불만을 표하셨습니다. 모든 지역의 말투는 각자의 고유한 가치를 지닌다는 주장이십니다.',
    '한국의 브라질 = 대구 한국의 멕시코 = 전라도한국의 인도 = 부산': '특정 지역의 특성을 타국의 사례에 빗대어 부정적으로 묘사하셨습니다. 지역 간의 갈등을 유발할 수 있는 냉소적인 비유가 느껴집니다.',
    '우리나라에도 미개한 파퀴 필리피노 조선족 이슬람 새키들 넘친다': '우리나라에 거주하는 외국인들과 특정 종교 신자들에 대해 극도의 적대감을 드러내며 미개하다고 비하하셨습니다.',
    '과학이고 증거고 뭐고 다 팔아먹었구만': '객관적인 근거와 사실을 완전히 무시하는 현재의 상황이 무척 실망스럽군요.'
}

rows = []
modified_count = 0
with open(path, 'r', encoding='utf-8') as f:
    reader = csv.reader(f, delimiter='\t')
    header = next(reader)
    rows.append(header)
    for row in reader:
        source = row[0]
        if source in fixes:
            row[1] = fixes[source]
            modified_count += 1
        rows.append(row)

with open(temp_path, 'w', encoding='utf-8', newline='') as f:
    writer = csv.writer(f, delimiter='\t')
    writer.writerows(rows)

os.replace(temp_path, path)
print(f'Successfully fixed {modified_count} items (removed preachy tone).')
